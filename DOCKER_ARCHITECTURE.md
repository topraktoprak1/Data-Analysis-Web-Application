# ğŸ“Š Docker Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User's Computer                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     Docker Engine                         â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   PostgreSQL    â”‚  â”‚   Flask/Python  â”‚  â”‚  Nginx   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   Container     â”‚  â”‚    Container    â”‚  â”‚Container â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  veri-analizi-  â”‚  â”‚  veri-analizi-  â”‚  â”‚veri-     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚       db        â”‚  â”‚       web       â”‚  â”‚analizi-  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚frontend  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Port: 5432    â”‚â—„â”€â”¤  Port: 5000    â”‚â—„â”€â”¤Port: 80  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚  Database   â”‚ â”‚  â”‚ â”‚   Flask     â”‚ â”‚  â”‚â”‚ React  â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚    Data     â”‚ â”‚  â”‚ â”‚   Backend   â”‚ â”‚  â”‚â”‚  SPA   â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚             â”‚ â”‚  â”‚ â”‚             â”‚ â”‚  â”‚â”‚        â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Tables    â”‚ â”‚  â”‚ â”‚  REST API   â”‚ â”‚  â”‚â”‚  UI    â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Indexes   â”‚ â”‚  â”‚ â”‚   Logic     â”‚ â”‚  â”‚â”‚        â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚             â”‚ â”‚  â”‚ â”‚  Uploads    â”‚ â”‚  â”‚â”‚        â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚           â”‚                    â”‚                  â”‚      â”‚ â”‚
â”‚  â”‚           â–¼                    â–¼                  â–¼      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚            Docker Volumes (Persistent)             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚postgres_ â”‚  â”‚uploads_  â”‚  â”‚  instance_    â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  data    â”‚  â”‚  data    â”‚  â”‚    data       â”‚   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚          Docker Network: app-network               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        (Internal communication between services)   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Ports exposed to host
                              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        Access Points (localhost)          â”‚
    â”‚                                           â”‚
    â”‚  ğŸŒ http://localhost         â†’ Nginx     â”‚
    â”‚  ğŸ”Œ http://localhost:5000    â†’ Flask     â”‚
    â”‚  ğŸ—„ï¸  localhost:5432          â†’ PostgreSQLâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### User Request Flow
```
1. User Browser
   â†“
   http://localhost
   â†“
2. Nginx Container (Port 80)
   â”‚
   â”œâ”€â†’ Serves React SPA (HTML/JS/CSS)
   â”‚
   â””â”€â†’ Proxies /api/* requests
       â†“
3. Flask Container (Port 5000)
   â”‚
   â”œâ”€â†’ Handles business logic
   â”œâ”€â†’ Processes file uploads
   â”‚
   â””â”€â†’ Queries database
       â†“
4. PostgreSQL Container (Port 5432)
   â”‚
   â””â”€â†’ Returns data
       â†“
5. Response flows back to user
```

## Container Communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx     â”‚ Service name: frontend
â”‚  Container  â”‚ Internal: http://frontend
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ External: localhost:80
       â”‚
       â”‚ HTTP proxy
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Flask     â”‚ Service name: web
â”‚  Container  â”‚ Internal: http://web:5000
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ External: localhost:5000
       â”‚
       â”‚ PostgreSQL protocol
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL  â”‚ Service name: db
â”‚  Container  â”‚ Internal: db:5432
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ External: localhost:5432
```

## Volume Mapping

```
Host Computer                  Docker Container
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Project Folder    â†’  (build time only)
  â”œâ”€ app.py
  â”œâ”€ requirements.txt
  â””â”€ frontend/

Docker Volumes    â†”  Container Runtime
  â”œâ”€ postgres_data    â†’  /var/lib/postgresql/data (database files)
  â”œâ”€ uploads_data     â†’  /app/uploads (user uploads)
  â””â”€ instance_data    â†’  /app/instance (app data)
```

## Network Isolation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  app-network (Bridge Network)           â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  db  â”‚â”€â”€â”€â”‚ web  â”‚â”€â”€â”€â”‚ frontâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                         â”‚
â”‚  Internal DNS resolution:               â”‚
â”‚  - db resolves to database container    â”‚
â”‚  - web resolves to backend container    â”‚
â”‚  - frontend resolves to nginx container â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Internet / Network              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ Firewall
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Host Computer                     â”‚
â”‚                                           â”‚
â”‚  Exposed Ports (Optional):                â”‚
â”‚  â”œâ”€ 80 (Frontend)                        â”‚
â”‚  â”œâ”€ 5000 (Backend)                       â”‚
â”‚  â””â”€ 5432 (Database - not recommended)    â”‚
â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Docker Internal Network  â”‚         â”‚
â”‚  â”‚   (Isolated by default)    â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚  â”œâ”€ All containers can      â”‚         â”‚
â”‚  â”‚  â”‚  communicate internally  â”‚         â”‚
â”‚  â”‚  â”‚                          â”‚         â”‚
â”‚  â”‚  â””â”€ Environment variables   â”‚         â”‚
â”‚  â”‚     for secrets             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Build Process

```
1. Build Backend
   â”œâ”€ FROM python:3.12-slim
   â”œâ”€ Install dependencies
   â”œâ”€ Copy application code
   â””â”€ Set up non-root user
   â†“
2. Build Frontend
   â”œâ”€ Stage 1: Build with Node.js
   â”‚   â”œâ”€ npm ci (install)
   â”‚   â””â”€ npm run build
   â”‚       â†“ produces /dist
   â””â”€ Stage 2: Serve with Nginx
       â”œâ”€ Copy dist files
       â””â”€ Configure nginx
   â†“
3. Start Services (docker-compose)
   â”œâ”€ Create network
   â”œâ”€ Create volumes
   â”œâ”€ Start database (wait for health)
   â”œâ”€ Start backend (depends on db)
   â””â”€ Start frontend (depends on backend)
```

## File Structure in Containers

```
Backend Container (/app)
â”œâ”€â”€ app.py
â”œâ”€â”€ app_package/
â”œâ”€â”€ templates/
â”œâ”€â”€ static/
â”œâ”€â”€ uploads/         (volume)
â””â”€â”€ instance/        (volume)

Frontend Container
â”œâ”€â”€ /usr/share/nginx/html/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ (built React app)
â””â”€â”€ /etc/nginx/conf.d/
    â””â”€â”€ default.conf (proxy config)

Database Container
â””â”€â”€ /var/lib/postgresql/data/  (volume)
    â”œâ”€â”€ base/
    â”œâ”€â”€ global/
    â””â”€â”€ pg_wal/
```

## Deployment Scenarios

### Local Development
```
Developer Computer
â”œâ”€â”€ Docker Desktop
â””â”€â”€ Project Folder
    â””â”€â”€ docker-compose up -d
```

### Production Server
```
Production Server
â”œâ”€â”€ Docker Engine
â”œâ”€â”€ Reverse Proxy (optional)
â”‚   â””â”€â”€ SSL/TLS termination
â””â”€â”€ docker-compose up -d
```

### Multiple Developers
```
Developer A          Developer B          Developer C
    â”‚                    â”‚                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    Git Repository
                         â”‚
                    Same config works!
```

## Health Check Flow

```
Docker Engine
   â”‚
   â”œâ”€> Database Health Check (every 10s)
   â”‚   â””â”€> pg_isready -U postgres
   â”‚
   â”œâ”€> Backend Health Check (every 30s)
   â”‚   â””â”€> GET /api/health
   â”‚       â””â”€> Tests DB connection
   â”‚
   â””â”€> Frontend Health Check (every 30s)
       â””â”€> GET / (nginx health)
```

---

## Legend

- `â†’` : Data flow direction
- `â†”` : Bidirectional communication
- `â”€â”¤` : Connection point
- `â”Œâ”â””â”˜â”œâ”¤` : Container boundaries
- `â–¼` : Process flow
